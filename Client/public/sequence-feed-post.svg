<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1600" height="900" viewBox="0 0 1600 900">
  <defs>
    <style>
      .bg { fill: #0f1115; }
      .laneTitle { fill: #e5e7eb; font: 600 16px Arial, Helvetica, sans-serif; }
      .step { fill: #d1d5db; font: 12px Arial, Helvetica, sans-serif; }
      .note { fill: #9ca3af; font: 12px Arial, Helvetica, sans-serif; }
      .box { fill: #1f2937; stroke: #4b5563; stroke-width: 2; rx: 6; }
      .pill { fill: #374151; stroke: #6b7280; stroke-width: 1.5; rx: 20; }
      .line { stroke: #9ca3af; stroke-width: 2; }
      .lifeline { stroke: #6b7280; stroke-width: 2; stroke-dasharray: 8 8; }
      .arrow { stroke: #e5e7eb; stroke-width: 2.5; marker-end: url(#arrowhead); }
      .arrowBack { stroke: #93c5fd; stroke-width: 2.5; marker-end: url(#arrowheadBlue); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="8" refX="10" refY="4" orient="auto">
      <polygon points="0 0, 10 4, 0 8" fill="#e5e7eb" />
    </marker>
    <marker id="arrowheadBlue" markerWidth="10" markerHeight="8" refX="10" refY="4" orient="auto">
      <polygon points="0 0, 10 4, 0 8" fill="#93c5fd" />
    </marker>
  </defs>

  <rect class="bg" x="0" y="0" width="1600" height="900" />

  <!-- Title -->
  <g>
    <rect x="520" y="18" width="560" height="44" class="pill" />
    <text x="800" y="46" text-anchor="middle" class="laneTitle">Feed Post Creation Flow (Janhit)</text>
  </g>

  <!-- Lanes -->
  <g id="lanes">
    <!-- Lane columns -->
    <g>
      <rect class="box" x="80" y="80" width="280" height="52" />
      <text x="220" y="112" text-anchor="middle" class="laneTitle">User</text>
      <line class="lifeline" x1="220" y1="140" x2="220" y2="840" />
    </g>
    <g>
      <rect class="box" x="420" y="80" width="300" height="52" />
      <text x="570" y="112" text-anchor="middle" class="laneTitle">Frontend (React SPA)</text>
      <line class="lifeline" x1="570" y1="140" x2="570" y2="840" />
    </g>
    <g>
      <rect class="box" x="770" y="80" width="310" height="52" />
      <text x="925" y="112" text-anchor="middle" class="laneTitle">Backend (Express + JWT)</text>
      <line class="lifeline" x1="925" y1="140" x2="925" y2="840" />
    </g>
    <g>
      <rect class="box" x="1110" y="80" width="220" height="52" />
      <text x="1220" y="112" text-anchor="middle" class="laneTitle">MongoDB</text>
      <line class="lifeline" x1="1220" y1="140" x2="1220" y2="840" />
    </g>
    <g>
      <rect class="box" x="1360" y="80" width="160" height="52" />
      <text x="1440" y="112" text-anchor="middle" class="laneTitle">Cloudinary</text>
      <line class="lifeline" x1="1440" y1="140" x2="1440" y2="840" />
    </g>
  </g>

  <!-- Steps -->
  <!-- 1. Compose & Preview -->
  <g>
    <rect class="pill" x="120" y="160" width="200" height="36" />
    <text class="step" x="220" y="183" text-anchor="middle">Types message & selects images</text>
    <line class="arrow" x1="220" y1="200" x2="570" y2="200" />
    <text class="step" x="390" y="195">Preview opens (editable fields)</text>
  </g>

  <!-- 2. Submit create post (with images) -->
  <g>
    <rect class="pill" x="470" y="230" width="200" height="36" />
    <text class="step" x="570" y="253" text-anchor="middle">Clicks "Post It"</text>
    <line class="arrow" x1="570" y1="270" x2="925" y2="270" />
    <text class="step" x="750" y="265">POST /api/v1/feed/posts/:userId (multipart)</text>

    <rect class="box" x="820" y="290" width="210" height="60" />
    <text class="step" x="925" y="315" text-anchor="middle">verifyJWT</text>
    <text class="note" x="925" y="332" text-anchor="middle">Bearer / cookie token</text>
  </g>

  <!-- 3. Multer stores to local uploads -->
  <g>
    <line class="arrow" x1="925" y1="360" x2="1440" y2="360" />
    <text class="step" x="1180" y="355" text-anchor="middle">Upload images</text>
    <text class="note" x="1440" y="376" text-anchor="middle">Optimize & get URLs</text>
  </g>

  <!-- 4. Save post to DB with media URLs -->
  <g>
    <line class="arrow" x1="925" y1="410" x2="1220" y2="410" />
    <text class="step" x="1070" y="405" text-anchor="middle">Save post document</text>
    <text class="note" x="1220" y="426" text-anchor="middle">posts, media, userId, city</text>
    <line class="arrowBack" x1="1220" y1="450" x2="925" y2="450" />
    <text class="step" x="1070" y="445" text-anchor="middle">OK (postId)</text>
  </g>

  <!-- 5. Respond 201 and update UI -->
  <g>
    <line class="arrowBack" x1="925" y1="500" x2="570" y2="500" />
    <text class="step" x="750" y="495" text-anchor="middle">201 Created (JSON post)</text>
    <line class="arrowBack" x1="570" y1="540" x2="220" y2="540" />
    <text class="step" x="395" y="535" text-anchor="middle">Closes preview, prepend to feed</text>
  </g>

  <!-- 6. Like / Bookmark interactions (protected) -->
  <g>
    <rect class="pill" x="120" y="600" width="200" height="36" />
    <text class="step" x="220" y="623" text-anchor="middle">Likes / Bookmarks</text>
    <line class="arrow" x1="220" y1="640" x2="570" y2="640" />
    <text class="step" x="395" y="635" text-anchor="middle">Toggle UI</text>
    <line class="arrow" x1="570" y1="670" x2="925" y2="670" />
    <text class="step" x="750" y="665" text-anchor="middle">POST /like or /bookmark</text>
    <line class="arrow" x1="925" y1="700" x2="1220" y2="700" />
    <text class="step" x="1070" y="695" text-anchor="middle">Update counters</text>
    <line class="arrowBack" x1="1220" y1="730" x2="570" y2="730" />
    <text class="step" x="900" y="725" text-anchor="middle">OK (new counts)</text>
  </g>

  <!-- Footer note -->
  <g>
    <text class="note" x="800" y="870" text-anchor="middle">Routes from server: /api/v1/feed (createPost, toggleLike, toggleBookmark), protected by verifyJWT; images optimized via Cloudinary.</text>
  </g>

</svg>












